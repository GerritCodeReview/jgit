load(
    "@bazel_tools//tools/jdk:default_java_toolchain.bzl",
    "default_java_toolchain",
)
load("@rules_java//java:defs.bzl", "java_package_configuration")

default_java_toolchain(
    name = "error_prone_warnings_toolchain_java11",
    package_configuration = [
        ":error_prone",
    ],
    source_version = "11",
    target_version = "11",
    visibility = ["//visibility:public"],
)

default_java_toolchain(
    name = "error_prone_warnings_toolchain_java17",
    configuration = dict(),
    java_runtime = "@bazel_tools//tools/jdk:remotejdk_17",
    package_configuration = [
        ":error_prone",
    ],
    source_version = "17",
    target_version = "17",
    visibility = ["//visibility:public"],
)

# Error Prone errors enabled by default; see ../.bazelrc for how this is
# enabled. This warnings list is originally based on:
# https://github.com/bazelbuild/BUILD_file_generator/blob/master/tools/bazel_defs/java.bzl
# However, feel free to add any additional errors. Thus far they have all been pretty useful.
java_package_configuration(
    name = "error_prone",
    javacopts = [
        "-XepDisableWarningsInGeneratedCode",
        # The XepDisableWarningsInGeneratedCode disables only warnings, but
        # not errors. We should manually exclude all files generated by
        # AutoValue; such files always start $AutoValue_.....
        # XepExcludedPaths is a regexp. If you need more paths - use | as
        # separator.
        "-XepExcludedPaths:.*/\\\\$$AutoValue_.*\\.java",
        "-Xep:AlmostJavadoc:WARN",
        "-Xep:AlwaysThrows:WARN",
        "-Xep:AmbiguousMethodReference:WARN",
        # don't want to add dependency to errorprone
        "-Xep:AnnotateFormatMethod:OFF",
        "-Xep:ArgumentSelectionDefectChecker:WARN",
        "-Xep:ArrayAsKeyOfSetOrMap:WARN",
        "-Xep:ArrayEquals:WARN",
        "-Xep:ArrayFillIncompatibleType:WARN",
        "-Xep:ArrayHashCode:WARN",
        "-Xep:ArraysAsListPrimitiveArray:WARN",
        "-Xep:ArrayToString:WARN",
        "-Xep:AssertEqualsArgumentOrderChecker:WARN",
        "-Xep:AssertionFailureIgnored:WARN",
        "-Xep:AsyncCallableReturnsNull:WARN",
        "-Xep:AsyncFunctionReturnsNull:WARN",
        "-Xep:AutoValueConstructorOrderChecker:WARN",
        "-Xep:AutoValueFinalMethods:WARN",
        "-Xep:AutoValueImmutableFields:WARN",
        "-Xep:AutoValueSubclassLeaked:WARN",
        "-Xep:BadAnnotationImplementation:WARN",
        "-Xep:BadComparable:WARN",
        "-Xep:BadImport:WARN",
        "-Xep:BadInstanceof:WARN",
        "-Xep:BadShiftAmount:WARN",
        "-Xep:BanSerializableRead:WARN",
        "-Xep:BigDecimalEquals:WARN",
        "-Xep:BigDecimalLiteralDouble:WARN",
        "-Xep:BoxedPrimitiveConstructor:WARN",
        "-Xep:BoxedPrimitiveEquality:WARN",
        "-Xep:BundleDeserializationCast:WARN",
        "-Xep:ByteBufferBackingArray:WARN",
        "-Xep:CacheLoaderNull:WARN",
        "-Xep:CannotMockFinalClass:WARN",
        "-Xep:CanonicalDuration:WARN",
        "-Xep:CatchAndPrintStackTrace:WARN",
        "-Xep:CatchFail:WARN",
        "-Xep:ChainedAssertionLosesContext:WARN",
        "-Xep:ChainingConstructorIgnoresParameter:WARN",
        "-Xep:CharacterGetNumericValue:WARN",
        "-Xep:CheckNotNullMultipleTimes:WARN",
        "-Xep:CheckReturnValue:WARN",
        "-Xep:ClassCanBeStatic:WARN",
        "-Xep:ClassName:WARN",
        "-Xep:ClassNewInstance:WARN",
        "-Xep:CollectionIncompatibleType:WARN",
        "-Xep:CollectionToArraySafeParameter:WARN",
        "-Xep:CollectionUndefinedEquality:WARN",
        "-Xep:CollectorShouldNotUseState:WARN",
        "-Xep:ComparableAndComparator:WARN",
        "-Xep:ComparableType:WARN",
        "-Xep:CompareToZero:WARN",
        "-Xep:ComparingThisWithNull:WARN",
        "-Xep:ComparisonOutOfRange:WARN",
        "-Xep:CompatibleWithAnnotationMisuse:WARN",
        "-Xep:CompileTimeConstant:WARN",
        "-Xep:ComplexBooleanConstant:WARN",
        "-Xep:ComputeIfAbsentAmbiguousReference:WARN",
        "-Xep:ConditionalExpressionNumericPromotion:WARN",
        "-Xep:ConstantOverflow:WARN",
        "-Xep:DaggerProvidesNull:WARN",
        "-Xep:DangerousLiteralNull:WARN",
        "-Xep:DateChecker:WARN",
        "-Xep:DateFormatConstant:WARN",
        "-Xep:DeadException:WARN",
        "-Xep:DeadThread:WARN",
        "-Xep:DefaultCharset:WARN",
        "-Xep:DefaultPackage:WARN",
        "-Xep:DepAnn:WARN",
        "-Xep:DeprecatedVariable:WARN",
        "-Xep:DiscardedPostfixExpression:WARN",
        "-Xep:DoNotCall:WARN",
        "-Xep:DoNotCallSuggester:WARN",
        "-Xep:DoNotClaimAnnotations:WARN",
        "-Xep:DoNotMock:WARN",
        "-Xep:DoNotMockAutoValue:WARN",
        "-Xep:DoubleBraceInitialization:WARN",
        "-Xep:DoubleCheckedLocking:WARN",
        "-Xep:DuplicateMapKeys:WARN",
        "-Xep:DurationFrom:WARN",
        "-Xep:DurationGetTemporalUnit:WARN",
        "-Xep:DurationTemporalUnit:WARN",
        "-Xep:DurationToLongTimeUnit:WARN",
        "-Xep:EmptyBlockTag:WARN",
        "-Xep:EmptyCatch:WARN",
        "-Xep:EmptySetMultibindingContributions:WARN",
        "-Xep:EqualsGetClass:WARN",
        "-Xep:EqualsHashCode:WARN",
        "-Xep:EqualsIncompatibleType:WARN",
        "-Xep:EqualsNaN:WARN",
        "-Xep:EqualsNull:WARN",
        "-Xep:EqualsReference:WARN",
        "-Xep:EqualsUnsafeCast:WARN",
        "-Xep:EqualsUsingHashCode:WARN",
        "-Xep:EqualsWrongThing:WARN",
        "-Xep:ErroneousThreadPoolConstructorChecker:WARN",
        "-Xep:EscapedEntity:WARN",
        "-Xep:ExpectedExceptionChecker:WARN",
        "-Xep:ExtendingJUnitAssert:WARN",
        "-Xep:ExtendsAutoValue:WARN",
        "-Xep:FallThrough:WARN",
        "-Xep:Finally:WARN",
        "-Xep:FloatCast:WARN",
        "-Xep:FloatingPointAssertionWithinEpsilon:WARN",
        "-Xep:FloatingPointLiteralPrecision:WARN",
        "-Xep:FloggerArgumentToString:WARN",
        "-Xep:FloggerFormatString:WARN",
        "-Xep:FloggerLogVarargs:WARN",
        "-Xep:FloggerSplitLogStatement:WARN",
        "-Xep:FloggerStringConcatenation:WARN",
        "-Xep:FormatString:WARN",
        "-Xep:FormatStringAnnotation:WARN",
        "-Xep:ForOverride:WARN",
        "-Xep:FragmentInjection:WARN",
        "-Xep:FragmentNotInstantiable:WARN",
        "-Xep:FromTemporalAccessor:WARN",
        "-Xep:FunctionalInterfaceClash:WARN",
        "-Xep:FunctionalInterfaceMethodChanged:WARN",
        "-Xep:FutureReturnValueIgnored:WARN",
        "-Xep:FuturesGetCheckedIllegalExceptionType:WARN",
        "-Xep:GetClassOnAnnotation:WARN",
        "-Xep:GetClassOnClass:WARN",
        "-Xep:GetClassOnEnum:WARN",
        "-Xep:GuardedBy:WARN",
        "-Xep:GuiceAssistedInjectScoping:WARN",
        "-Xep:GuiceAssistedParameters:WARN",
        "-Xep:HashtableContains:WARN",
        "-Xep:HidingField:WARN",
        "-Xep:IdentityBinaryExpression:WARN",
        "-Xep:IdentityHashMapBoxing:WARN",
        "-Xep:IdentityHashMapUsage:WARN",
        "-Xep:IgnoredPureGetter:WARN",
        "-Xep:Immutable:WARN",
        "-Xep:ImmutableAnnotationChecker:WARN",
        "-Xep:ImmutableEnumChecker:WARN",
        "-Xep:ImmutableModification:WARN",
        "-Xep:Incomparable:WARN",
        "-Xep:IncompatibleArgumentType:WARN",
        "-Xep:IncompatibleModifiers:WARN",
        "-Xep:InconsistentCapitalization:WARN",
        "-Xep:InconsistentHashCode:WARN",
        "-Xep:IncrementInForLoopAndHeader:WARN",
        "-Xep:IndexOfChar:WARN",
        "-Xep:InexactVarargsConditional:WARN",
        "-Xep:InfiniteRecursion:WARN",
        "-Xep:InheritDoc:WARN",
        "-Xep:InjectOnConstructorOfAbstractClass:WARN",
        "-Xep:InlineFormatString:WARN",
        "-Xep:InlineMeInliner:WARN",
        # don't want to add dependency to errorprone
        "-Xep:InlineMeSuggester:OFF",
        "-Xep:InlineMeValidator:WARN",
        "-Xep:InputStreamSlowMultibyteRead:WARN",
        "-Xep:InsecureCryptoUsage:WARN",
        "-Xep:InstanceOfAndCastMatchWrongType:WARN",
        "-Xep:InstantTemporalUnit:WARN",
        "-Xep:IntLongMath:WARN",
        "-Xep:InvalidBlockTag:WARN",
        "-Xep:InvalidInlineTag:WARN",
        "-Xep:InvalidJavaTimeConstant:WARN",
        "-Xep:InvalidLink:WARN",
        "-Xep:InvalidParam:WARN",
        "-Xep:InvalidPatternSyntax:WARN",
        "-Xep:InvalidThrows:WARN",
        "-Xep:InvalidThrowsLink:WARN",
        "-Xep:InvalidTimeZoneID:WARN",
        "-Xep:InvalidZoneId:WARN",
        "-Xep:IsInstanceIncompatibleType:WARN",
        "-Xep:IsInstanceOfClass:WARN",
        "-Xep:IsLoggableTagLength:WARN",
        "-Xep:IterableAndIterator:WARN",
        "-Xep:IterablePathParameter:WARN",
        "-Xep:JavaDurationGetSecondsGetNano:WARN",
        "-Xep:JavaDurationWithNanos:WARN",
        "-Xep:JavaDurationWithSeconds:WARN",
        "-Xep:JavaInstantGetSecondsGetNano:WARN",
        "-Xep:JavaLangClash:WARN",
        "-Xep:JavaLocalDateTimeGetNano:WARN",
        "-Xep:JavaLocalTimeGetNano:WARN",
        "-Xep:JavaPeriodGetDays:WARN",
        "-Xep:JavaTimeDefaultTimeZone:WARN",
        "-Xep:JavaUtilDate:WARN",
        "-Xep:JdkObsolete:WARN",
        "-Xep:JodaConstructors:WARN",
        "-Xep:JodaDateTimeConstants:WARN",
        "-Xep:JodaDurationWithMillis:WARN",
        "-Xep:JodaInstantWithMillis:WARN",
        "-Xep:JodaNewPeriod:WARN",
        "-Xep:JodaPlusMinusLong:WARN",
        "-Xep:JodaTimeConverterManager:WARN",
        "-Xep:JodaToSelf:WARN",
        "-Xep:JodaWithDurationAddedLong:WARN",
        "-Xep:JUnit3FloatingPointComparisonWithoutDelta:WARN",
        "-Xep:JUnit3TestNotRun:WARN",
        "-Xep:JUnit4ClassAnnotationNonStatic:WARN",
        "-Xep:JUnit4ClassUsedInJUnit3:WARN",
        "-Xep:JUnit4SetUpNotRun:WARN",
        "-Xep:JUnit4TearDownNotRun:WARN",
        "-Xep:JUnit4TestNotRun:WARN",
        "-Xep:JUnit4TestsNotRunWithinEnclosed:WARN",
        "-Xep:JUnitAmbiguousTestClass:WARN",
        "-Xep:JUnitAssertSameCheck:WARN",
        "-Xep:JUnitParameterMethodNotFound:WARN",
        "-Xep:LiteByteStringUtf8:WARN",
        "-Xep:LiteEnumValueOf:WARN",
        "-Xep:LiteProtoToString:WARN",
        "-Xep:LocalDateTemporalAmount:WARN",
        "-Xep:LockNotBeforeTry:WARN",
        "-Xep:LockOnBoxedPrimitive:WARN",
        "-Xep:LogicalAssignment:WARN",
        "-Xep:LongFloatConversion:WARN",
        "-Xep:LongLiteralLowerCaseSuffix:WARN",
        "-Xep:LoopConditionChecker:WARN",
        "-Xep:LoopOverCharArray:WARN",
        "-Xep:LossyPrimitiveCompare:WARN",
        "-Xep:MathAbsoluteRandom:WARN",
        "-Xep:MathRoundIntLong:WARN",
        "-Xep:MemoizeConstantVisitorStateLookups:WARN",
        "-Xep:MislabeledAndroidString:WARN",
        "-Xep:MissingCasesInEnumSwitch:WARN",
        "-Xep:MissingFail:WARN",
        "-Xep:MissingOverride:WARN",
        "-Xep:MissingSummary:WARN",
        "-Xep:MissingSuperCall:WARN",
        "-Xep:MissingTestCall:WARN",
        "-Xep:MisusedDayOfYear:WARN",
        "-Xep:MisusedWeekYear:WARN",
        "-Xep:MixedDescriptors:WARN",
        "-Xep:MixedMutabilityReturnType:WARN",
        "-Xep:MockitoUsage:WARN",
        "-Xep:ModifiedButNotUsed:WARN",
        "-Xep:ModifyCollectionInEnhancedForLoop:WARN",
        "-Xep:ModifyingCollectionWithItself:WARN",
        "-Xep:ModifySourceCollectionInStream:WARN",
        "-Xep:MultipleParallelOrSequentialCalls:WARN",
        "-Xep:MultipleUnaryOperatorsInMethodCall:WARN",
        "-Xep:MustBeClosedChecker:WARN",
        "-Xep:MutableConstantField:WARN",
        # Java provides no good alternative
        "-Xep:MutablePublicArray:OFF",
        "-Xep:NarrowingCompoundAssignment:WARN",
        "-Xep:NCopiesOfChar:WARN",
        "-Xep:NestedInstanceOfConditions:WARN",
        "-Xep:NonAtomicVolatileUpdate:WARN",
        "-Xep:NonCanonicalStaticImport:WARN",
        "-Xep:NonCanonicalType:WARN",
        "-Xep:NonFinalCompileTimeConstant:WARN",
        "-Xep:NonOverridingEquals:WARN",
        "-Xep:NonRuntimeAnnotation:WARN",
        "-Xep:NullableConstructor:WARN",
        "-Xep:NullablePrimitive:WARN",
        "-Xep:NullablePrimitiveArray:WARN",
        "-Xep:NullableVoid:WARN",
        "-Xep:NullOptional:WARN",
        "-Xep:NullTernary:WARN",
        "-Xep:ObjectEqualsForPrimitives:WARN",
        "-Xep:ObjectsHashCodePrimitive:WARN",
        "-Xep:ObjectToString:WARN",
        "-Xep:OperatorPrecedence:WARN",
        "-Xep:OptionalEquality:WARN",
        "-Xep:OptionalMapToOptional:WARN",
        "-Xep:OptionalMapUnusedValue:WARN",
        "-Xep:OptionalNotPresent:WARN",
        "-Xep:OptionalOfRedundantMethod:WARN",
        "-Xep:OrphanedFormatString:WARN",
        "-Xep:OutlineNone:WARN",
        "-Xep:OverlappingQualifierAndScopeAnnotation:WARN",
        "-Xep:Overrides:WARN",
        "-Xep:OverridesGuiceInjectableMethod:WARN",
        "-Xep:OverridesJavaxInjectableMethod:WARN",
        "-Xep:OverrideThrowableToString:WARN",
        "-Xep:PackageInfo:WARN",
        "-Xep:ParameterName:WARN",
        "-Xep:ParametersButNotParameterized:WARN",
        "-Xep:ParcelableCreator:WARN",
        "-Xep:PeriodFrom:WARN",
        "-Xep:PeriodGetTemporalUnit:WARN",
        "-Xep:PeriodTimeMath:WARN",
        "-Xep:PreconditionsCheckNotNullRepeated:WARN",
        "-Xep:PreconditionsInvalidPlaceholder:WARN",
        "-Xep:PreferredInterfaceType:OFF",
        "-Xep:PrimitiveAtomicReference:WARN",
        "-Xep:PrivateSecurityContractProtoAccess:WARN",
        "-Xep:ProtectedMembersInFinalClass:WARN",
        "-Xep:ProtoBuilderReturnValueIgnored:WARN",
        "-Xep:ProtocolBufferOrdinal:WARN",
        "-Xep:ProtoDurationGetSecondsGetNano:WARN",
        "-Xep:ProtoFieldNullComparison:WARN",
        "-Xep:ProtoFieldPreconditionsCheckNotNull:WARN",
        "-Xep:ProtoRedundantSet:WARN",
        "-Xep:ProtoStringFieldReferenceEquality:WARN",
        "-Xep:ProtoTimestampGetSecondsGetNano:WARN",
        "-Xep:ProtoTruthMixedDescriptors:WARN",
        "-Xep:ProvidesMethodOutsideOfModule:WARN",
        "-Xep:RandomCast:WARN",
        "-Xep:RandomModInteger:WARN",
        "-Xep:ReachabilityFenceUsage:WARN",
        "-Xep:RectIntersectReturnValueIgnored:WARN",
        "-Xep:ReferenceEquality:WARN",
        "-Xep:RefersToDaggerCodegen:WARN",
        "-Xep:RemovedInJDK11:WARN",
        "-Xep:RequiredModifiers:WARN",
        "-Xep:RestrictedApiChecker:WARN",
        "-Xep:RethrowReflectiveOperationExceptionAsLinkageError:WARN",
        "-Xep:ReturnFromVoid:WARN",
        "-Xep:ReturnValueIgnored:WARN",
        "-Xep:RxReturnValueIgnored:WARN",
        "-Xep:SameNameButDifferent:WARN",
        "-Xep:SelfAssignment:WARN",
        "-Xep:SelfComparison:WARN",
        "-Xep:SelfEquals:WARN",
        "-Xep:ShortCircuitBoolean:WARN",
        "-Xep:ShouldHaveEvenArgs:WARN",
        "-Xep:SizeGreaterThanOrEqualsZero:WARN",
        "-Xep:StaticAssignmentInConstructor:WARN",
        "-Xep:StaticGuardedByInstance:WARN",
        "-Xep:StaticMockMember:WARN",
        "-Xep:StaticQualifiedUsingExpression:WARN",
        "-Xep:StreamToString:WARN",
        "-Xep:StringBuilderInitWithChar:WARN",
        "-Xep:StringEquality:WARN",
        "-Xep:StringSplitter:WARN",
        "-Xep:SubstringOfZero:WARN",
        "-Xep:SuppressWarningsDeprecated:WARN",
        "-Xep:SwigMemoryLeak:WARN",
        "-Xep:SynchronizeOnNonFinalField:WARN",
        "-Xep:TemporalAccessorGetChronoField:WARN",
        "-Xep:TestParametersNotInitialized:WARN",
        "-Xep:TheoryButNoTheories:WARN",
        "-Xep:ThreadJoinLoop:WARN",
        "-Xep:ThreadLocalUsage:WARN",
        "-Xep:ThreadPriorityCheck:WARN",
        "-Xep:ThreeLetterTimeZoneID:WARN",
        "-Xep:ThrowIfUncheckedKnownChecked:WARN",
        "-Xep:ThrowNull:WARN",
        "-Xep:TimeUnitConversionChecker:WARN",
        "-Xep:ToStringReturnsNull:WARN",
        "-Xep:TreeToString:WARN",
        "-Xep:TruthAssertExpected:WARN",
        "-Xep:TruthConstantAsserts:WARN",
        "-Xep:TruthGetOrDefault:WARN",
        "-Xep:TruthIncompatibleType:WARN",
        "-Xep:TruthSelfEquals:WARN",
        "-Xep:TryFailThrowable:WARN",
        "-Xep:TypeEquals:WARN",
        "-Xep:TypeNameShadowing:WARN",
        "-Xep:TypeParameterQualifier:WARN",
        "-Xep:TypeParameterShadowing:WARN",
        "-Xep:TypeParameterUnusedInFormals:WARN",
        "-Xep:UndefinedEquals:WARN",
        "-Xep:UnescapedEntity:WARN",
        "-Xep:UnnecessaryAssignment:WARN",
        "-Xep:UnnecessaryCheckNotNull:WARN",
        "-Xep:UnnecessaryLambda:WARN",
        "-Xep:UnnecessaryMethodInvocationMatcher:WARN",
        "-Xep:UnnecessaryMethodReference:WARN",
        "-Xep:UnnecessaryParentheses:WARN",
        "-Xep:UnnecessaryTypeArgument:WARN",
        "-Xep:UnrecognisedJavadocTag:WARN",
        "-Xep:UnsafeFinalization:WARN",
        "-Xep:UnsafeReflectiveConstructionCast:WARN",
        "-Xep:UnsynchronizedOverridesSynchronized:WARN",
        "-Xep:UnusedAnonymousClass:WARN",
        "-Xep:UnusedCollectionModifiedInPlace:WARN",
        "-Xep:UnusedException:WARN",
        "-Xep:UnusedMethod:WARN",
        "-Xep:UnusedNestedClass:WARN",
        "-Xep:UnusedVariable:WARN",
        "-Xep:URLEqualsHashCode:WARN",
        "-Xep:UseBinds:WARN",
        "-Xep:UseCorrectAssertInTests:WARN",
        "-Xep:VariableNameSameAsType:WARN",
        "-Xep:VarTypeName:WARN",
        "-Xep:WaitNotInLoop:WARN",
        "-Xep:WakelockReleasedDangerously:WARN",
        "-Xep:WildcardImport:WARN",
        "-Xep:WithSignatureDiscouraged:WARN",
        "-Xep:WrongOneof:WARN",
        "-Xep:XorPower:WARN",
        "-Xep:ZoneIdOfZ:WARN",
    ],
    packages = ["error_prone_packages"],
)

package_group(
    name = "error_prone_packages",
    packages = [
        "//org.eclipse.jgit.ant.test/...",
        "//org.eclipse.jgit.ant/...",
        "//org.eclipse.jgit.archive/...",
        "//org.eclipse.jgit.gpg.bc.test/...",
        "//org.eclipse.jgit.gpg.bc/...",
        "//org.eclipse.jgit.http.apache/...",
        "//org.eclipse.jgit.http.server/...",
        "//org.eclipse.jgit.http.test/...",
        "//org.eclipse.jgit.junit.ssh/...",
        "//org.eclipse.jgit.junit/...",
        "//org.eclipse.jgit.junit/http/...",
        "//org.eclipse.jgit.lfs.server.test/...",
        "//org.eclipse.jgit.lfs.server/...",
        "//org.eclipse.jgit.lfs.test/...",
        "//org.eclipse.jgit.lfs/...",
        "//org.eclipse.jgit.pgm.test/...",
        "//org.eclipse.jgit.pgm/...",
        "//org.eclipse.jgit.ssh.apache.agent/...",
        "//org.eclipse.jgit.ssh.apache.test/...",
        "//org.eclipse.jgit.ssh.apache/...",
        "//org.eclipse.jgit.ssh.jsch.test/...",
        "//org.eclipse.jgit.ssh.jsch/...",
        "//org.eclipse.jgit.test/...",
        "//org.eclipse.jgit.ui/...",
        "//org.eclipse.jgit/...",
    ],
)
