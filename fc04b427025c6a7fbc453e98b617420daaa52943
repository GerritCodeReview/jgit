{
  "comments": [
    {
      "key": {
        "uuid": "62cc4474_f4b5f448",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/transport/FetchProcess.java",
        "patchSetId": 3
      },
      "lineNbr": 525,
      "author": {
        "id": 97483
      },
      "writtenOn": "2022-02-03T09:33:54Z",
      "side": 1,
      "message": "Whilst this get rid of the use of a deprecated method, it would double the memory used during the execution of this method.\n\nIf you look at the RefDatabase implementation of getRefsByPrefix, it uses internally the getRefs and does the conversion into a List\u003cRef\u003e. Why not making a getRefsStreamByPrefix() and returning a stream of refs instead? You could then use the stream directly here and in many other places.\n\nMoving forward, when navigating refs, we should *always* avoid to get all of them in memory: any part of the JGit code should think about \"navigating\" refs rather than having all of them in memory, which could be problematic for a large mono-repo.\n\nWDYT?\n\n@Thomas @Matthias any opinion on the above?",
      "range": {
        "startLine": 523,
        "startChar": 0,
        "endLine": 525,
        "endChar": 30
      },
      "revId": "fc04b427025c6a7fbc453e98b617420daaa52943",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b0d1218a_cd937186",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/transport/FetchProcess.java",
        "patchSetId": 3
      },
      "lineNbr": 525,
      "author": {
        "id": 4
      },
      "writtenOn": "2022-02-03T22:13:34Z",
      "side": 1,
      "message": "this sounds tempting though I think it\u0027s non-trivial to implement\n\nfor RefDirectory we have to care for (see RefDirectory#getRefs(String)):\n- packed-refs\n- loose refs\n- symbolic refs which need to be resolved\n- loose refs take precedence over entries with the same name in packed-refs (see RefMap#get(Object))\n\nI guess for RefTable this is more straight forward",
      "parentUuid": "62cc4474_f4b5f448",
      "range": {
        "startLine": 523,
        "startChar": 0,
        "endLine": 525,
        "endChar": 30
      },
      "revId": "fc04b427025c6a7fbc453e98b617420daaa52943",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4a26f48a_83850f96",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/transport/FetchProcess.java",
        "patchSetId": 3
      },
      "lineNbr": 525,
      "author": {
        "id": 97483
      },
      "writtenOn": "2022-02-04T11:06:08Z",
      "side": 1,
      "message": "\u003e this sounds tempting though I think it\u0027s non-trivial to implement\n\nTrue, but the getRefs() already creates a stream() and then do a collection as List\u003cRef\u003e. It could just expose that stream() as a new method (getRefsStream()) for now, so that localRefs() doesn\u0027t have to create yet another one for collecting it directly.\n\nFor the non-trivial of the full change of reading refs in a streaming fashion: yes, I know, but we are here to help in doing non-trivial stuff :-)\n\nI know refTable would be easier, but also refTable isn\u0027t production-ready yet and isn\u0027t supported on c-git either. Also, even when it will be production-ready and supported in c-git, the RefDirectory will continue to be supported for a while I imagine.",
      "parentUuid": "b0d1218a_cd937186",
      "range": {
        "startLine": 523,
        "startChar": 0,
        "endLine": 525,
        "endChar": 30
      },
      "revId": "fc04b427025c6a7fbc453e98b617420daaa52943",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    }
  ]
}