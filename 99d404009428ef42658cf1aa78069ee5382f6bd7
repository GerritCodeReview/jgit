{
  "comments": [
    {
      "key": {
        "uuid": "67ccbf7d_c5a4cc05",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/pack/PackWriterBitmapPreparer.java",
        "patchSetId": 1
      },
      "lineNbr": 375,
      "author": {
        "id": 1628
      },
      "writtenOn": "2015-11-04T07:05:29Z",
      "side": 1,
      "message": "This line just looks wrong to me. We can\u0027t assume that all the reused bitmaps from a previous pack are all in a single linear history, so ORing in \"reuse\" here seems incorrect.\n\nI think the way to move forward is to simplify and clarify semantics (like you are doing by replacing BitmapBuilder.add()) and add tests that verify those semantics. Then maybe things won\u0027t be so murky. I\u0027ll think about a test for this.",
      "range": {
        "startLine": 375,
        "startChar": 0,
        "endLine": 375,
        "endChar": 20
      },
      "revId": "99d404009428ef42658cf1aa78069ee5382f6bd7",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "67ccbf7d_6589407a",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/pack/PackWriterBitmapPreparer.java",
        "patchSetId": 1
      },
      "lineNbr": 375,
      "author": {
        "id": 951
      },
      "writtenOn": "2015-11-04T07:12:51Z",
      "side": 1,
      "message": "I don\u0027t think there\u0027s any assumption of linearity. I wonder if it\u0027s a vestige of some code path that doesn\u0027t exist any more. I can do a little history mining tomorrow.\n\nBut (luckily?) if I am reading correctly it would be safe to remove this line. Consider where this bitmap is used after this line:\n\n1. It gets recorded in tipCommitBitmaps\n2. In the while((rc \u003d rw.next()) !\u003d null) walk, we check if it contains each commit \u0027rc\u0027. Luckily the commits in \u0027reuse\u0027 cannot appear as \u0027rc\u0027, since each commit in reuseCommits has already been marked uninteresting.\n3. We then AND the bitmap against the complement of reuse.\n\nSo the OR-ing against reuse would have had no effect, since it was soon undone.",
      "parentUuid": "67ccbf7d_c5a4cc05",
      "range": {
        "startLine": 375,
        "startChar": 0,
        "endLine": 375,
        "endChar": 20
      },
      "revId": "99d404009428ef42658cf1aa78069ee5382f6bd7",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "67ccbf7d_36b1302e",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/pack/PackWriterBitmapPreparer.java",
        "patchSetId": 1
      },
      "lineNbr": 375,
      "author": {
        "id": 1628
      },
      "writtenOn": "2015-11-04T16:06:59Z",
      "side": 1,
      "message": "I\u0027m not making my point very well. This loop is setting up the full reachability bitmap for each branch tip. It may be the case that some of the commits for which we are reusing bitmaps are not reachable by a particular branch. If not, then the bitmaps for those commits should not be used to build the bitmap for that branch tip. This line seems to be violating that.",
      "parentUuid": "67ccbf7d_6589407a",
      "range": {
        "startLine": 375,
        "startChar": 0,
        "endLine": 375,
        "endChar": 20
      },
      "revId": "99d404009428ef42658cf1aa78069ee5382f6bd7",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "67ccbf7d_16dc2cdb",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/pack/PackWriterBitmapPreparer.java",
        "patchSetId": 1
      },
      "lineNbr": 375,
      "author": {
        "id": 951
      },
      "writtenOn": "2015-11-04T18:53:28Z",
      "side": 1,
      "message": "Upshot of in-person conversation:\n\n- the bitmap.or(reuse) and bitmap.andNot(reuse) calls do not appear to be needed. Will add a change to remove those calls\n- the content of the BitmapBuilder in tipCommitBitmaps is underdocumented. Will add a comment in the same or a followup change.",
      "parentUuid": "67ccbf7d_36b1302e",
      "range": {
        "startLine": 375,
        "startChar": 0,
        "endLine": 375,
        "endChar": 20
      },
      "revId": "99d404009428ef42658cf1aa78069ee5382f6bd7",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": false
    }
  ]
}