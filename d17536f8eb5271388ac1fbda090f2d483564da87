{
  "comments": [
    {
      "key": {
        "uuid": "2e6a35c1_cab3e69a",
        "filename": "org.eclipse.jgit.test/tst/org/eclipse/jgit/internal/storage/file/BatchRefUpdateTest.java",
        "patchSetId": 4
      },
      "lineNbr": 238,
      "author": {
        "id": 4
      },
      "writtenOn": "2021-06-10T07:36:50Z",
      "side": 1,
      "message": "AFAICS the problem here is that if useReftable is true refdir\u003dnull\n\nShouldn\u0027t we use the corresponding reftable implementation instead of skipping the exact lookup of these refs ?\n\n RefDatabase refDB \u003d diskRepo.getRefDatabase();\n refDB.exactRef(\"refs/heads/master\");\n refDB.exactRef(\"refs/heads/masters\");",
      "range": {
        "startLine": 235,
        "startChar": 0,
        "endLine": 238,
        "endChar": 3
      },
      "revId": "d17536f8eb5271388ac1fbda090f2d483564da87",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "74e0faee_0c97642d",
        "filename": "org.eclipse.jgit.test/tst/org/eclipse/jgit/internal/storage/file/BatchRefUpdateTest.java",
        "patchSetId": 4
      },
      "lineNbr": 238,
      "author": {
        "id": 98905
      },
      "writtenOn": "2021-06-10T08:18:01Z",
      "side": 1,
      "message": "exactRef is an accessor function, so it\u0027s unclear what these two calls doing. comment? Assert something about the return value?",
      "parentUuid": "2e6a35c1_cab3e69a",
      "range": {
        "startLine": 235,
        "startChar": 0,
        "endLine": 238,
        "endChar": 3
      },
      "revId": "d17536f8eb5271388ac1fbda090f2d483564da87",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e0e2b60_c3f355ec",
        "filename": "org.eclipse.jgit.test/tst/org/eclipse/jgit/internal/storage/file/BatchRefUpdateTest.java",
        "patchSetId": 4
      },
      "lineNbr": 238,
      "author": {
        "id": 301453
      },
      "writtenOn": "2021-06-10T17:41:29Z",
      "side": 1,
      "message": "The purpose of these two calls is to force the refs-changed events to be fired for the two loose refs that were created using writeLooseRefs. We do this to get the events fired during the test \u0027setup\u0027 out of the way and this allows us to now accurately assert only for the new events fired during the BatchRefUpdate.\n\nwriteLooseRefs function creates refs differently based on useReftable.\n\nWhen useReftable\u003dfalse, refs are created using FileUtils, so we explicitly call refdir.exactRef to fire the events for those loose refs. When useReftable\u003dtrue, the loose refs are created using RefUpdate which likely already fires the events, so there is no need to explicitly call a function to fire those events.",
      "parentUuid": "74e0faee_0c97642d",
      "range": {
        "startLine": 235,
        "startChar": 0,
        "endLine": 238,
        "endChar": 3
      },
      "revId": "d17536f8eb5271388ac1fbda090f2d483564da87",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6045390b_aa4b5abb",
        "filename": "org.eclipse.jgit.test/tst/org/eclipse/jgit/internal/storage/file/BatchRefUpdateTest.java",
        "patchSetId": 4
      },
      "lineNbr": 238,
      "author": {
        "id": 4
      },
      "writtenOn": "2021-06-10T20:00:09Z",
      "side": 1,
      "message": "then I\u0027d propose to do this compensation inside writeLooseRef() if useReftable\u003dfalse and add a comment there explaining the reason why this is done",
      "parentUuid": "8e0e2b60_c3f355ec",
      "range": {
        "startLine": 235,
        "startChar": 0,
        "endLine": 238,
        "endChar": 3
      },
      "revId": "d17536f8eb5271388ac1fbda090f2d483564da87",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "112a9ac8_246faa9c",
        "filename": "org.eclipse.jgit.test/tst/org/eclipse/jgit/internal/storage/file/BatchRefUpdateTest.java",
        "patchSetId": 4
      },
      "lineNbr": 238,
      "author": {
        "id": 301453
      },
      "writtenOn": "2021-06-10T20:09:58Z",
      "side": 1,
      "message": "I didn\u0027t do that to start with because we don\u0027t want the exactRef() calls in the tests where we don\u0027t assert for refsChanged events. For example in the test above this one (simpleNoForce()). I tried to explain the need for these new tests in the commit message of the original change: https://git.eclipse.org/r/c/jgit/jgit/+/180696/7//COMMIT_MSG \n\nI can still push these calls inside writeLooseRef() and have a flag to fire the events on need basis if that\u0027s alright.",
      "parentUuid": "6045390b_aa4b5abb",
      "range": {
        "startLine": 235,
        "startChar": 0,
        "endLine": 238,
        "endChar": 3
      },
      "revId": "d17536f8eb5271388ac1fbda090f2d483564da87",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "be5e6f78_cdfe895e",
        "filename": "org.eclipse.jgit.test/tst/org/eclipse/jgit/internal/storage/file/BatchRefUpdateTest.java",
        "patchSetId": 4
      },
      "lineNbr": 238,
      "author": {
        "id": 4
      },
      "writtenOn": "2021-06-13T21:51:05Z",
      "side": 1,
      "message": "I think this flag isn\u0027t necessary",
      "parentUuid": "112a9ac8_246faa9c",
      "range": {
        "startLine": 235,
        "startChar": 0,
        "endLine": 238,
        "endChar": 3
      },
      "revId": "d17536f8eb5271388ac1fbda090f2d483564da87",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f600016b_84875489",
        "filename": "org.eclipse.jgit.test/tst/org/eclipse/jgit/internal/storage/file/BatchRefUpdateTest.java",
        "patchSetId": 4
      },
      "lineNbr": 238,
      "author": {
        "id": 301453
      },
      "writtenOn": "2021-06-14T21:46:01Z",
      "side": 1,
      "message": "Alright. Thanks Matthias.",
      "parentUuid": "be5e6f78_cdfe895e",
      "range": {
        "startLine": 235,
        "startChar": 0,
        "endLine": 238,
        "endChar": 3
      },
      "revId": "d17536f8eb5271388ac1fbda090f2d483564da87",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": false
    }
  ]
}