{
  "comments": [
    {
      "key": {
        "uuid": "b3109b0a_ac5cb604",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/transport/BasePackConnection.java",
        "patchSetId": 2
      },
      "lineNbr": 229,
      "author": {
        "id": 951
      },
      "writtenOn": "2018-12-19T17:13:31Z",
      "side": 1,
      "message": "Can we use a length check instead of a regex? I.e.\n\n  if (line.length() \u003c 41 || line.charAt(40) !\u003d \u0027 \u0027) {\n    ... report the error ...\n  }\n  String name \u003d line.substring(41, line.length());\n\n  ...\n  ObjectId id;\n  try {\n    id \u003d ObjectId.fromString(line.substring(0, 40));\n  } catch (InvalidObjectIdException e) {\n    ... report the error ...\n  }",
      "revId": "c4528b8d6b9f00dcd5e6a38dc68e563f4708da55",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e1f2b548_b0090fc4",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/transport/BasePackConnection.java",
        "patchSetId": 2
      },
      "lineNbr": 229,
      "author": {
        "id": 925
      },
      "writtenOn": "2018-12-20T00:13:23Z",
      "side": 1,
      "message": "Is there any specific reason to not use regex?\n\nI was trying to avoid the use of magic numbers, so would rather not go with a solution that adds more of them.  When I initially read the code it wasn\u0027t immediately obvious what it was supposed to be doing.\n\nAlso, do we actually want to report an error here?  My intention was to skip over anything that isn\u0027t a sha1/name combination, so that it doesn\u0027t choke on the v2 response that has additional lines.\n\nThat said, it\u0027s probably not sufficient to only do this change. There are likely other parts of the client code that don\u0027t behave properly with v2.",
      "parentUuid": "b3109b0a_ac5cb604",
      "revId": "c4528b8d6b9f00dcd5e6a38dc68e563f4708da55",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8cee3335_a67774d9",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/transport/BasePackConnection.java",
        "patchSetId": 2
      },
      "lineNbr": 229,
      "author": {
        "id": 951
      },
      "writtenOn": "2018-12-20T00:15:05Z",
      "side": 1,
      "message": "\u003e Is there any specific reason to not use regex?\n\nJust painful experience with debugging regexes. Regex matching also seems like overkill here.\n\n \u003e There are likely other parts of the client code that don\u0027t behave properly with v2.\n\nCan you elaborate? Are you saying RuntimeException doesn\u0027t get handled properly by the caller?",
      "parentUuid": "e1f2b548_b0090fc4",
      "revId": "c4528b8d6b9f00dcd5e6a38dc68e563f4708da55",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dee71f4d_56db68ea",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/transport/BasePackConnection.java",
        "patchSetId": 2
      },
      "lineNbr": 229,
      "author": {
        "id": 925
      },
      "writtenOn": "2018-12-20T00:57:56Z",
      "side": 1,
      "message": "\u003e Regex matching also seems like overkill here.\n\nI was going for readability, but point taken.\n\nI will rework this change to only check the length and fail if it\u0027s not the expected length,  i.e. per the suggested fix in your previous  comment.\n\n\u003e Can you elaborate? Are you saying RuntimeException doesn\u0027t get handled properly by the caller?\n\nNo, I mean that even after this fix, which allows it to return the advertised refs in v2, there is still something not working somewhere because in my test on gerrit it\u0027s not getting the expected refs.  I\u0027ve added you on the relevant change (which atm is a private change so I won\u0027t link it here).",
      "parentUuid": "8cee3335_a67774d9",
      "revId": "c4528b8d6b9f00dcd5e6a38dc68e563f4708da55",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    }
  ]
}